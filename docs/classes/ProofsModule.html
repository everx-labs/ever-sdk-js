<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>ProofsModule | @eversdk/core</title><meta name="description" content="Documentation for @eversdk/core"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script async src="../assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">@eversdk/core</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><ul class="tsd-breadcrumb"><li><a href="../modules.html">@eversdk/core</a></li><li><a href="ProofsModule.html">ProofsModule</a></li></ul><h1>Class ProofsModule </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><div class="lead">
<p><a href="UNSTABLE.md">UNSTABLE</a> Module for proving data, retrieved from TONOS API.</p>
</div></div></section><section class="tsd-panel tsd-hierarchy"><h3>Hierarchy</h3><ul class="tsd-hierarchy"><li><span class="target">ProofsModule</span></li></ul></section><section class="tsd-panel-group tsd-index-group"><h2>Index</h2><section class="tsd-panel tsd-index-panel"><div class="tsd-index-content"><section class="tsd-index-section "><h3>Constructors</h3><ul class="tsd-index-list"><li class="tsd-kind-constructor tsd-parent-kind-class"><a href="ProofsModule.html#constructor" class="tsd-kind-icon">constructor</a></li></ul></section><section class="tsd-index-section "><h3>Properties</h3><ul class="tsd-index-list"><li class="tsd-kind-property tsd-parent-kind-class"><a href="ProofsModule.html#client" class="tsd-kind-icon">client</a></li></ul></section><section class="tsd-index-section "><h3>Methods</h3><ul class="tsd-index-list"><li class="tsd-kind-method tsd-parent-kind-class"><a href="ProofsModule.html#proof_block_data" class="tsd-kind-icon">proof_<wbr/>block_<wbr/>data</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="ProofsModule.html#proof_message_data" class="tsd-kind-icon">proof_<wbr/>message_<wbr/>data</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="ProofsModule.html#proof_transaction_data" class="tsd-kind-icon">proof_<wbr/>transaction_<wbr/>data</a></li></ul></section></div></section></section><section class="tsd-panel-group tsd-member-group "><h2>Constructors</h2><section class="tsd-panel tsd-member tsd-kind-constructor tsd-parent-kind-class"><a id="constructor" class="tsd-anchor"></a><h3 class="tsd-anchor-link">constructor<a href="#constructor" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-constructor tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">new <wbr/>Proofs<wbr/>Module<span class="tsd-signature-symbol">(</span>client<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">IClient</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="ProofsModule.html" class="tsd-signature-type" data-tsd-kind="Class">ProofsModule</a></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/tonlabs/ever-sdk-js/blob/cee86ac/packages/core/src/modules.ts#L8993">modules.ts:8993</a></li></ul></aside><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>client: <span class="tsd-signature-type">IClient</span></h5></li></ul><h4 class="tsd-returns-title">Returns <a href="ProofsModule.html" class="tsd-signature-type" data-tsd-kind="Class">ProofsModule</a></h4></li></ul></section></section><section class="tsd-panel-group tsd-member-group "><h2>Properties</h2><section class="tsd-panel tsd-member tsd-kind-property tsd-parent-kind-class"><a id="client" class="tsd-anchor"></a><h3 class="tsd-anchor-link">client<a href="#client" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><div class="tsd-signature tsd-kind-icon">client<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">IClient</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/tonlabs/ever-sdk-js/blob/cee86ac/packages/core/src/modules.ts#L8991">modules.ts:8991</a></li></ul></aside></section></section><section class="tsd-panel-group tsd-member-group "><h2>Methods</h2><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class"><a id="proof_block_data" class="tsd-anchor"></a><h3 class="tsd-anchor-link">proof_<wbr/>block_<wbr/>data<a href="#proof_block_data" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">proof_<wbr/>block_<wbr/>data<span class="tsd-signature-symbol">(</span>params<span class="tsd-signature-symbol">: </span><a href="../modules.html#ParamsOfProofBlockData" class="tsd-signature-type" data-tsd-kind="Type alias">ParamsOfProofBlockData</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/tonlabs/ever-sdk-js/blob/cee86ac/packages/core/src/modules.ts#L9063">modules.ts:9063</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Proves that a given block&#39;s data, which is queried from TONOS API, can be trusted.</p>
</div><dl class="tsd-comment-tags"><dt>remarks</dt><dd><p>This function checks block proofs and compares given data with the proven.
If the given data differs from the proven, the exception will be thrown.
The input param is a single block&#39;s JSON object, which was queried from DApp server using
functions such as <code>net.query</code>, <code>net.query_collection</code> or <code>net.wait_for_collection</code>.
If block&#39;s BOC is not provided in the JSON, it will be queried from DApp server
(in this case it is required to provide at least <code>id</code> of block).</p>
<p>Please note, that joins (like <code>signatures</code> in <code>Block</code>) are separated entities and not supported,
so function will throw an exception in a case if JSON being checked has such entities in it.</p>
<p>If <code>cache_in_local_storage</code> in config is set to <code>true</code> (default), downloaded proofs and
master-chain BOCs are saved into the persistent local storage (e.g. file system for native
environments or browser&#39;s IndexedDB for the web); otherwise all the data is cached only in
memory in current client&#39;s context and will be lost after destruction of the client.</p>
<p><strong>Why Proofs are needed</strong></p>
<p>Proofs are needed to ensure that the data downloaded from a DApp server is real blockchain
data. Checking proofs can protect from the malicious DApp server which can potentially provide
fake data, or also from &quot;Man in the Middle&quot; attacks class.</p>
<p><strong>What Proofs are</strong></p>
<p>Simply, proof is a list of signatures of validators&#39;, which have signed this particular master-
block.</p>
<p>The very first validator set&#39;s public keys are included in the zero-state. Whe know a root hash
of the zero-state, because it is stored in the network configuration file, it is our authority
root. For proving zero-state it is enough to calculate and compare its root hash.</p>
<p>In each new validator cycle the validator set is changed. The new one is stored in a key-block,
which is signed by the validator set, which we already trust, the next validator set will be
stored to the new key-block and signed by the current validator set, and so on.</p>
<p>In order to prove any block in the master-chain we need to check, that it has been signed by
a trusted validator set. So we need to check all key-blocks&#39; proofs, started from the zero-state
and until the block, which we want to prove. But it can take a lot of time and traffic to
download and prove all key-blocks on a client. For solving this, special trusted blocks are used
in Ever-SDK.</p>
<p>The trusted block is the authority root, as well, as the zero-state. Each trusted block is the
<code>id</code> (e.g. <code>root_hash</code>) of the already proven key-block. There can be plenty of trusted
blocks, so there can be a lot of authority roots. The hashes of trusted blocks for MainNet
and DevNet are hardcoded in SDK in a separated binary file (trusted_key_blocks.bin) and is
being updated for each release by using <code>update_trusted_blocks</code> utility.</p>
<p>See <a href="../../../tools/update_trusted_blocks">update_trusted_blocks</a> directory for more info.</p>
<p>In future SDK releases, one will also be able to provide their hashes of trusted blocks for
other networks, besides for MainNet and DevNet.
By using trusted key-blocks, in order to prove any block, we can prove chain of key-blocks to
the closest previous trusted key-block, not only to the zero-state.</p>
<p>But shard-blocks don&#39;t have proofs on DApp server. In this case, in order to prove any shard-
block data, we search for a corresponding master-block, which contains the root hash of this
shard-block, or some shard block which is linked to that block in shard-chain. After proving
this master-block, we traverse through each link and calculate and compare hashes with links,
one-by-one. After that we can ensure that this shard-block has also been proven.</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>params: <a href="../modules.html#ParamsOfProofBlockData" class="tsd-signature-type" data-tsd-kind="Type alias">ParamsOfProofBlockData</a></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4><div></div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class"><a id="proof_message_data" class="tsd-anchor"></a><h3 class="tsd-anchor-link">proof_<wbr/>message_<wbr/>data<a href="#proof_message_data" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">proof_<wbr/>message_<wbr/>data<span class="tsd-signature-symbol">(</span>params<span class="tsd-signature-symbol">: </span><a href="../modules.html#ParamsOfProofMessageData" class="tsd-signature-type" data-tsd-kind="Type alias">ParamsOfProofMessageData</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/tonlabs/ever-sdk-js/blob/cee86ac/packages/core/src/modules.ts#L9117">modules.ts:9117</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Proves that a given message&#39;s data, which is queried from TONOS API, can be trusted.</p>
</div><dl class="tsd-comment-tags"><dt>remarks</dt><dd><p>This function first proves the corresponding transaction, ensures that the proven transaction
refers to the given message and compares given data with the proven.
If the given data differs from the proven, the exception will be thrown.
The input parameter is a single message&#39;s JSON object (see params description),
which was queried from TONOS API using functions such as <code>net.query</code>, <code>net.query_collection</code>
or <code>net.wait_for_collection</code>.</p>
<p>If message&#39;s BOC and/or non-null <code>src_transaction.id</code> or <code>dst_transaction.id</code> are not provided
in the JSON, they will be queried from TONOS API.</p>
<p>Please note, that joins (like <code>block</code>, <code>dst_account</code>, <code>dst_transaction</code>, <code>src_account</code>,
<code>src_transaction</code>, etc. in <code>Message</code> entity) are separated entities and not supported,
so function will throw an exception in a case if JSON being checked has such entities in it.</p>
<p>For more information about proofs checking, see description of <code>proof_block_data</code> function.</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>params: <a href="../modules.html#ParamsOfProofMessageData" class="tsd-signature-type" data-tsd-kind="Type alias">ParamsOfProofMessageData</a></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4><div></div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class"><a id="proof_transaction_data" class="tsd-anchor"></a><h3 class="tsd-anchor-link">proof_<wbr/>transaction_<wbr/>data<a href="#proof_transaction_data" aria-label="Permalink" class="tsd-anchor-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path><path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path></svg></a></h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">proof_<wbr/>transaction_<wbr/>data<span class="tsd-signature-symbol">(</span>params<span class="tsd-signature-symbol">: </span><a href="../modules.html#ParamsOfProofTransactionData" class="tsd-signature-type" data-tsd-kind="Type alias">ParamsOfProofTransactionData</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/tonlabs/ever-sdk-js/blob/cee86ac/packages/core/src/modules.ts#L9090">modules.ts:9090</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Proves that a given transaction&#39;s data, which is queried from TONOS API, can be trusted.</p>
</div><dl class="tsd-comment-tags"><dt>remarks</dt><dd><p>This function requests the corresponding block, checks block proofs, ensures that given
transaction exists in the proven block and compares given data with the proven.
If the given data differs from the proven, the exception will be thrown.
The input parameter is a single transaction&#39;s JSON object (see params description),
which was queried from TONOS API using functions such as <code>net.query</code>, <code>net.query_collection</code>
or <code>net.wait_for_collection</code>.</p>
<p>If transaction&#39;s BOC and/or <code>block_id</code> are not provided in the JSON, they will be queried from
TONOS API.</p>
<p>Please note, that joins (like <code>account</code>, <code>in_message</code>, <code>out_messages</code>, etc. in <code>Transaction</code>
entity) are separated entities and not supported, so function will throw an exception in a case
if JSON being checked has such entities in it.</p>
<p>For more information about proofs checking, see description of <code>proof_block_data</code> function.</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>params: <a href="../modules.html#ParamsOfProofTransactionData" class="tsd-signature-type" data-tsd-kind="Type alias">ParamsOfProofTransactionData</a></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4><div></div></li></ul></section></section></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class=""><a href="../modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="current tsd-kind-class"><a href="ProofsModule.html" class="tsd-kind-icon">Proofs<wbr/>Module</a><ul><li class="tsd-kind-constructor tsd-parent-kind-class"><a href="ProofsModule.html#constructor" class="tsd-kind-icon">constructor</a></li><li class="tsd-kind-property tsd-parent-kind-class"><a href="ProofsModule.html#client" class="tsd-kind-icon">client</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="ProofsModule.html#proof_block_data" class="tsd-kind-icon">proof_<wbr/>block_<wbr/>data</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="ProofsModule.html#proof_message_data" class="tsd-kind-icon">proof_<wbr/>message_<wbr/>data</a></li><li class="tsd-kind-method tsd-parent-kind-class"><a href="ProofsModule.html#proof_transaction_data" class="tsd-kind-icon">proof_<wbr/>transaction_<wbr/>data</a></li></ul></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="../assets/main.js"></script></body></html>